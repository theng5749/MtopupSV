@{
    ViewBag.Title = "Home Page";
}

<h4 style="text-align:center;margin-top:20px;margin-bottom:20px;font-weight:bold;">
    ສະບາຍດີ
    @if (ViewBag.ApproveName != null)
    {
        @ViewBag.ApproveName
    }
</h4>
@*<h4 style="text-align:center">ກະລຸນາຢືນຢັນການຕື່ມເງິນ</h4>*@


@*full image module*@
<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel">ເອກະສານເລກທີ : @ViewBag.DocNo</h4>
            </div>
            <div class="modal-body">
                <img src="" id="imagepreview" style="width:100%;">
            </div>
        </div>        
    </div>
</div>

@*<div id="imagemodal" class="modal">
        <span class="close" style="color:white;font-size:40px;">&times;</span>
        <img class="modal-content" id="imagepreview" style="width:100%;">
    </div>*@

<div class="row">
    <div class="col-lg-12 col-md-12 col-xs-12">
        <div style="box-shadow:0 5px 10px grey;border-radius:6px;padding-top:26px;padding-left:36px;padding-right:36px;padding-bottom:26px;">
            @using (Html.BeginForm("Index", "Home", FormMethod.Post, new { }))
            {
                if (ViewBag.ResultCode == "200")
                {
                    <img src="~/Files/iconcomfirm.png" height="80" width="90" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:16px;" />
                }
                else if (ViewBag.ResultCode == "500")
                {
                    <h4 style="text-align: center;"><strong style="color:red;">@ViewBag.Result</strong></h4>
                    <hr />
                }
                else if (ViewBag.ResultCode == "1000")
                {
                    <img src="~/Files/50percent-01-01.png" height="70" width="140" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:16px;" />
                    <h4 style="text-align: center;"><strong style="color:darkslategrey;">@ViewBag.Result</strong></h4>
                    <h5 style="text-align: center;"><strong style="color:darkslategrey;">@DateTime.Now.ToString("dd-MM-yyyy HH:mm")</strong></h5>
                    <hr />

                }
                else if (ViewBag.ResultCode == "2000")
                {
                    <img src="~/Files/100percent-01-01.png" height="70" width="140" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:16px;" />
                    <h4 style="text-align: center;"><strong style="color:darkslategrey;">@ViewBag.Result</strong></h4>
                    <h5 style="text-align: center;"><strong style="color:darkslategrey;">@DateTime.Now.ToString("dd-MM-yyyy HH:mm")</strong></h5>
                    <hr />

                }
                else
                {
                    <img src="~/Files/iconcomfirm.png" height="80" width="90" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:16px;" />
                    <h4 style="text-align: center;"><strong style="color:red;">@ViewBag.Result</strong></h4>
            <h4 style="text-align: center;"><strong style="color:red;">@ViewBag.ResultDesc</strong></h4>
                    <hr />
                }

                <h5 style="text-align:center;margin-bottom:16px;"><strong style="align-content:center">ລາຍລະອຽດ</strong></h5>


                <p style="text-align:left;">
                    <strong>ເບີໂທ:</strong>
                    <span style="float:right;">
                        @ViewBag.Msisdn
                    </span>
                </p>
                <p style="text-align:left;">
                    <strong>ບໍລິສັດ:</strong>
                    <span style="float:right;">
                        @ViewBag.Name
                    </span>
                </p>
                <p style="text-align:left;">
                    <strong>ຈຳນວນເງິນທີ່ຕື່ມ:</strong>
                    <span style="float:right;">
                        @ViewBag.Amount
                    </span>
                </p>


                if (ViewBag.ResultCode == "200")
                {
                    <p style="text-align:left;">
                        <strong>ຈຳນວນເງິນກ່ອນຕື່ມ:</strong>
                        <span style="float:right;">
                            @ViewBag.Result
                        </span>
                    </p>
                    <p style="text-align:left;margin-bottom:-15px">
                        <span style="float:right;">
                            + @ViewBag.Amount <br />

                        </span>
                    </p>
                    <br />
                    <hr />
                    <p style="text-align:left;margin-top:-15px;">
                        <strong>ຈຳນວນເງິນທັງໝົດ:</strong>
                        <span style="float:right;">
                            @ViewBag.AmountTotal <br />
                        </span>
                    </p>
                    <hr />

                }
                else if (ViewBag.ResultCode == "1000")
                {

                    <p style="text-align:left;">
                        <strong>ຈຳນວນເງິນກ່ອນຕື່ມ:</strong>
                        <span style="float:right;">
                            @ViewBag.OldAmount
                        </span>
                    </p>
                    <p style="text-align:left;margin-bottom:-15px">
                        <span style="float:right;">
                            + @ViewBag.Amount <br />

                        </span>
                    </p>
                    <br />
                    <hr />
                    <p style="text-align:left;margin-top:-15px;">
                        <strong>ຈຳນວນເງິນທັງໝົດ:</strong>
                        <span style="float:right;">
                            @ViewBag.AmountTotal <br />
                        </span>
                    </p>
                }
                else if (ViewBag.ResultCode == "2000")
                {

                    <p style="text-align:left;">
                        <strong>ຈຳນວນເງິນກ່ອນຕື່ມ:</strong>
                        <span style="float:right;">
                            @ViewBag.OldAmount
                        </span>
                    </p>
                    <p style="text-align:left;margin-bottom:-15px">
                        <span style="float:right;">
                            + @ViewBag.Amount <br />

                        </span>
                    </p>
                    <br />
                    <hr />
                    <p style="text-align:left;margin-top:-15px;">
                        <strong>ຈຳນວນເງິນທັງໝົດ:</strong>
                        <span style="float:right;">
                            @ViewBag.AmountTotal <br />
                        </span>
                    </p>
                }


        <div class="row">
            @if (ViewBag.ResultCode == "200")
            {
                <h5 style="text-align:center;margin-bottom:16px;margin-top:-10px;">ເອກະສານເລກທີ : @ViewBag.DocNo</h5>
                <a href="#" id="pop">
                    <img id="imageresource" src="" height="80" width="80" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:16px;">
                </a>
                <p style="text-align:center;">
                    <strong>ປ້ອນລະຫັດ OTP</strong>
                </p>
                <input required type="number" autocomplete="off" name="txtotp" class="form-control" style="width:240px;margin-left:auto;margin-right:auto;border-radius:24px;margin-bottom:-15px;" />

            }
        </div>
                <div class="row">
                    <input name="Msisdn" type="text" hidden value="@ViewBag.Msisdn" />
                    <input name="amount" type="text" hidden value="@ViewBag.Amount" />
                    <input name="MsisdnApprove" type="text" hidden value="@ViewBag.MsisdnApprove" />
                    <input name="name" type="text" hidden value="@ViewBag.Name" />
                    <input name="result" type="text" hidden value="@ViewBag.Result" />
                    <input name="Id" type="text" hidden value="@ViewBag.Id" />
                    <input name="MemberID" type="text" hidden value="@ViewBag.MemberID" />
                    <input name="Type" type="text" hidden value="@ViewBag.Type" />
                    <input name="nameApprove" type="text" hidden value="@ViewBag.ApproveName" />
                    <input name="OldAmount" type="text" hidden value="@ViewBag.OldAmount" />
                    <input name="TotalAmount" type="text" hidden value="@ViewBag.TotalAmount" />
                    <input name="Balance" type="text" hidden value="@ViewBag.Balance" />
                    <input name="OldAMT" type="text" hidden value="@ViewBag.OldAMT" />
                    <input name="NewAMT" type="text" hidden value="@ViewBag.NewAMT" />
                </div>
                <br />
                <hr />
                if (ViewBag.ResultCode == "200")
                {
                    <input type="submit" class="btn btn-primary btn-block" value="ຢືນຢັນ" style="margin-left:auto;margin-right:auto;border-radius:22px;margin-bottom:10px;">
                }


            }
            @if (ViewBag.ResultCode == "200")
            {
                <input type="submit" class="btn btn-danger btn-sm btn-block" data-toggle="modal" data-target="#CancelModal" value="ຍົກເລີກ" style="margin-left:auto;margin-right:auto;border-radius:22px;">
            }
        </div>

    </div>
</div>


<div class="row">
    @using (Html.BeginForm("Confirm", "Home", FormMethod.Post, new { }))
    {
        <!-- Modal -->
        <div class="modal fade" id="CancelModal" role="dialog">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">ກະລຸນາໃສ່ເຫດຜົນ</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <input name="Msisdn" type="text" hidden value="@ViewBag.Msisdn" />
                            <input name="amount" type="text" hidden value="@ViewBag.Amount" />
                            <input name="MsisdnApprove" type="text" hidden value="@ViewBag.MsisdnApprove" />
                            <input name="name" type="text" hidden value="@ViewBag.Name" />
                            <input name="result" type="text" hidden value="@ViewBag.Result" />
                            <input name="Id" type="text" hidden value="@ViewBag.Id" />
                            <input name="MemberID" type="text" hidden value="@ViewBag.MemberID" />
                            <input name="Type" type="text" hidden value="@ViewBag.Type" />
                            <input name="nameApprove" type="text" hidden value="@ViewBag.ApproveName" />
                            <input name="OldAmount" type="text" hidden value="@ViewBag.OldAmount" />
                            <input name="TotalAmount" type="text" hidden value="@ViewBag.TotalAmount" />
                            <input name="Balance" type="text" hidden value="@ViewBag.Balance" />
                        </div>
                        <input required type="text" autocomplete="off" name="comment" class="form-control" />
                    </div>
                    <div class="modal-footer">
                        <input class="btn btn-primary" type="submit" value="ຕົກລົງ">
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@section scripts{
    <script>
    $("#pop").on("click", function () {
        $('#imagepreview').attr('src', $('#imageresource').attr('src')); // here asign the image to the modal when the user click the enlarge link
        $('#imagemodal').modal('show'); // imagemodal is the id attribute assigned to the bootstrap modal, then i use the show function
    });



        @*if (@ViewBag.Image != '') {

        }*@
        var imagePath = '@ViewBag.Image';
        console.log(imagePath);
        $('#imageresource').attr('src', '@Url.Action("RenderImage", "Home")?id=' + imagePath);


    //var modal = document.getElementById("imagemodal");
    //var img = document.getElementById("imageresource");
    //var modalImg = document.getElementById("imagepreview");
    //img.onclick = function () {
    //    modal.style.display = "block";
    //    modalImg.src = this.src;
    //}

    //var span = document.getElementsByClassName("close")[0];
    //span.onclick = function () {
    //    modal.style.display = "none";
    //}

    </script>
}


